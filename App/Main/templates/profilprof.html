{% extends "base.html" %}

{% block content %} 
<style>
  body {
    background-color: #f5f5f5;
  }
  /* Add more CSS styling as needed */
</style>

<div class="container" style="margin-top: 100px;">
  <div class="row">
    <div class="col-md-8">
      <!-- Biography Card -->
      <div class="card mb-4" style="font-family: 'Kanit';">
        <div class="card-header  text-center font-weight-bold" style="background-color: blue;color: white;">BIOGRAPHIE</div>
        <div class="card-body" style="margin-left: 30%; word-wrap: break-word;">
          <p class="m-0">{{ bio }}</p>
        </div>
        <div class="card-body">
          <div class="profile-picture" style="height: 120px; margin-top: -50px;">
            <img src="../{{ photo }}" alt="Photo de profil" class="img-fluid" style="height: 100px; width: 100px; border-radius: 50%; overflow: hidden;">
          </div>
          <div class="bio">
            <p style="color: black; font-weight: bolder;">{{ nom }} {{ Prenom }}</p>
          </div>
        </div>
      </div>

      <!-- Rating Card -->
      <div class="card mb-4">
        <div class="card-header  text-center font-weight-bold" style="color: rgb(249, 249, 249);background-color: blue;">NOTE</div>
        <div class="card-body">
          <div id="rating" class="rating text-center">
            <!-- Ratings stars will be generated here using JavaScript -->
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <!-- Information Card -->
      <div class="card mb-4" style="font-family: 'Kanit';">
        <div class="card-header  text-center font-weight-bold" style="background-color: blue;color: white;">INFORMATIONS</div>
        <div class="card-body mt-3" style="height: 300px;">
          <p style="color: black;"><strong>Discipline(s) enseignée(s):</strong> {{ Discipline }}</p>
          <p style="color: black;"><strong>Formation:</strong> {{ Formation }}</p>
          <p style="color: black;"><strong>Niveau d'étude:</strong> {{ Niveau }}</p>
          <p style="color: black;"><strong>Nationalité:</strong> {{ nat }}</p>
          <p style="color: black;"><strong>Dernier diplôme obtenu:</strong> {{ Diplome }}</p>
        </div>
      </div>
    </div>
  </div>

  {% if user_type == "etudiant" %}
  <form method="POST" action="#">
    <div class="comment-form">
      <textarea name="commentaire" style="width: 66%; height: 100px; resize: none;border: none;border-radius: 10px;" placeholder="Commenter..."></textarea><br>
      <button class="btn btn" style="background-color: blue;"><i class="fa fa-paper-plane" style="color: white;"></i></button>
    </div>
  </form>
  {% endif %}

  <br>
  <div style="font-family: 'Kanit'; font-size: 18px;color: blue;">Commentaires</div>
  <br>
  <div id="comment-container">
    {% for commentaire in commentaires %}
    <div class="commentaire" style="background-color: white; border-radius: 10px; padding: 10px 20px 20px 20px;width: 66%;margin-bottom: 10px;" data-comment-id="{{ commentaire.id }}">
      <div class="auteur"><strong>{{ commentaire.commentateurs.nom }} {{ commentaire.commentateurs.prenom }}</strong></div>
      <div class="contenu">{{ commentaire.commentaire }}</div>
    </div>
    {% endfor %}
    <button id="load-more" style="background-color: transparent;color: blue;text-decoration: underline;border: none;">Voir plus</button>
  </div>
  
</div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.7/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<!-- Rest of your content goes here -->
<script>
const commentContainer = document.getElementById("comment-container");
  const loadMoreButton = document.getElementById("load-more");
  const comments = document.querySelectorAll(".commentaire");
  let visibleComments = 3;
  const commentsPerLoad = 3;

  loadMoreButton.addEventListener("click", function () {
    for (let i = visibleComments; i < visibleComments + commentsPerLoad && i < comments.length; i++) {
      comments[i].style.display = "block";
    }
    visibleComments += commentsPerLoad;

    // Vérifie si tous les commentaires ont été affichés
    if (visibleComments >= comments.length) {
      loadMoreButton.style.display = "none";
    }
  });

  // Cache les commentaires initialement
  for (let i = visibleComments; i < comments.length; i++) {
    comments[i].style.display = "none";
  }

  if (comments.length <= visibleComments) {
    loadMoreButton.style.display = "none";
  }



     const ratingValue =`{{ note }} `;
    function generateRating(rating) {
  const ratingContainer = document.getElementById('rating');
  ratingContainer.innerHTML = '';

  for (let i = 0; i < 5; i++) {
    const star = document.createElement('span');
    star.classList.add('star');

    if (i < rating) {
      star.style.color = 'gold';
    } else {
      star.style.color = 'black';
    }

    star.innerHTML = '&#9733;';
    ratingContainer.appendChild(star);
  }
}

// Exemple d'utilisation avec un rating de 3
generateRating(ratingValue);


// Fonction pour générer la liste déroulante des commentaires
function genererListeDeroulante() {
  const select = document.createElement("select");

  commentaires.forEach((commentaire, index) => {
    const option = document.createElement("option");
    option.value = index;
    option.textContent = commentaire.auteur;
    select.appendChild(option);
  });

  select.addEventListener("change", afficherCommentaire);

  return select;
}

// Fonction pour afficher le commentaire sélectionné
function afficherCommentaire(event) {
  const commentaireIndex = event.target.value;
  const commentaire = commentaires[commentaireIndex];

  const commentairesDiv = document.getElementById("commentaires");
  commentairesDiv.textContent = commentaire.commentaire;
}


</script>
{% endblock %}